package textExcel;

// Update this file with your own code.

public class Spreadsheet implements Grid
{
	private Cell[][] array;
	
	public Spreadsheet(){
		array = new Cell [20][12];
		for(int i = 0; i < array.length; i++){
			for( int j = 0; j < array[i].length; j++){
				array[i][j] = new EmptyCell();
			}
		}
	}
	
	@Override
	public String processCommand(String command)
	{
		// TODO Auto-generated method stub
		if(command.length() <= 3){
			int[] rowCol = rowAndCol(command);
			return (array[rowCol[0]][rowCol[1]].fullCellText());
		}else if(command.contains("clear")){
			if(command.length() > 7){
				String[] split = command.split(" ");
				clear(split[1]);
				return getGridText();
			}else{
				for(int i = 0; i < array.length; i++ ){
					for(char j = 'a'; j < array[i].length; j++){
						array[j][i] = new EmptyCell();
					}
				}
				return getGridText();
			}
		}else if(command.split(" ").length == 3){
			String[] split = command.split(" ");
			int[] loc = rowAndCol(command);
			array[loc[0]][loc[1]] = new TextCell(split[2]);
			
		}
		
		return "";
	}

	@Override
	public int getRows()
	{
		// TODO Auto-generated method stub
		return array.length;
	}

	@Override
	public int getCols()
	{
		// TODO Auto-generated method stub
		return array[1].length;
	}

	@Override
	public Cell getCell(Location loc)
	{
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String getGridText()
	{
		// TODO Auto-generated method stub
		return null;
	}
	
	public Cell getCell(Cell location){
		if(location instanceof EmptyCell){
			return location.abbreviatedCellText();
		}else if(location instanceof TextCell){
			return 
		}
		
	}
	
	public int[] rowAndCol(String input){
		int[] returnVal= new int[2];
		SpreadsheetLocation loc = new SpreadsheetLocation(input);
		returnVal[0] = loc.getRow();
		returnVal[1] = loc.getCol();
		return returnVal;
	}
	
	public void clear(String command){
		int[] loc = rowAndCol(command);
		array[loc[0]][loc[1]] = new EmptyCell();
	}

}
