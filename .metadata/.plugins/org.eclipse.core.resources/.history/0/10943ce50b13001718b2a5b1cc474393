//Brandon Nguyen, 2nd Period
package textExcel;

public class FormulaCell extends RealCell{
	
	private String formula;
	private Cell[][] grid;

	public FormulaCell(String formula, Cell[][] spreadsheet) {
		// TODO Auto-generated constructor stub
		this.formula = formula;
		this.grid = spreadsheet;
		setRealCell(formula);
	}

	public double getDoubleValue(){
		String[] formula = getRealCell().split(" ");
		if(formula.length == 3){
			//System.out.println(formula[1]);
			return Double.parseDouble(formula[1]);
		}
		
		if(formula[1].equals("AVG")){
			while(formula[2] != formula[4]){
				avg(formula[2], 0, 0, formula[4]);
			}
		}else{
			
		}
		double storeVal = 0.0;
		for(int i = 1; i < formula.length - 2; i += 2 ){
			double num = Double.parseDouble(formula[i]);
			//System.out.println(num);
			double secondNum = Double.parseDouble(formula[i + 2]);
			//System.out.println(secondNum);
			
			if(formula[i + 1].equals("*")){
				storeVal = num * secondNum;
			}else if(formula[i + 1].equals("/")){
				storeVal = num / secondNum;
			}else if(formula[i + 1].equals("+")){
				storeVal = num + secondNum;
			}else{
				storeVal = num - secondNum;
			}
			formula[i+2] = Double.toString(storeVal);
			//System.out.println(formula[i+2]);
			//System.out.println(storeVal);
		}
		return storeVal;
	}
	
	/*public double avg(String cell, double sum, int count, String end){
		SpreadsheetLocation loc = new SpreadsheetLocation(cell);
		if(cell.equals(end)){
			SpreadsheetLocation area = new SpreadsheetLocation(end);
			sum += Double.parseDouble(grid[loc.getRow()][loc.getCol()].fullCellText())
					* Double.parseDouble(grid[area.getRow()][area.getCol()].fullCellText());
			sum = sum / (double)count;
			return sum;
		}else{
			double first = 
					Double.parseDouble(grid[loc.getRow()][loc.getCol()].fullCellText());
			double second = 
					Double.parseDouble(grid[loc.getRow() + 1][loc.getCol() + 1].fullCellText());
			sum += first * second;
			
		}
		
	}*/
}
