//Brandon Nguyen, 2nd Period
package textExcel;

public class FormulaCell extends RealCell{
	
	private String formula;

	public FormulaCell(String formula) {
		// TODO Auto-generated constructor stub
		this.formula = formula;
		setRealCell(formula);
		System.out.println(formula);
	}

	public double getDoubleValue(){
		String[] formula = getRealCell().split(" ");
		if(formula.length == 3){
			//System.out.println(formula[1]);
			return Double.parseDouble(formula[1]);
		}
		double storeVal = 0.0;
		for(int i = 1; i < formula.length - 2; i += 2 ){
			double num = Double.parseDouble(formula[i]);
			//System.out.println(num);
			double secondNum = Double.parseDouble(formula[i + 2]);
			//System.out.println(secondNum);
			
			if(formula[i + 1].equals("*")){
				storeVal = num * secondNum;
			}else if(formula[i + 1].equals("/")){
				storeVal = num / secondNum;
			}else if(formula[i + 1].equals("+")){
				storeVal = num + secondNum;
			}else{
				storeVal = num - secondNum;
			}
			formula[i+2] = Double.toString(storeVal);
			//System.out.println(formula[i+2]);
			//System.out.println(storeVal);
		}
		return storeVal;
	}
}
